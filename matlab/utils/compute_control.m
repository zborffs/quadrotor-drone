function u_control = compute_control(x, parameters)
%compute_control(x, parameters) asdf 
%   asdfasdfasdf asdf 

xhat = x(13:24,:);
z = x(25:28,:);

K1 = [
  -1.674244784831501   0.000000000000009  -1.016264801768898  -1.628534516152433   0.000000000000008  -0.782794147314374   0.000000000000018   7.025177770998418   1.450963485097345   0.000000000000002   1.705111264474679   1.855295035085838;
   0.000000000000007  -1.674244784831507   1.016264801768899   0.000000000000002  -1.628534516152438   0.782794147314373  -7.025177770998422  -0.000000000000011   1.450963485097345  -1.705111264474683  -0.000000000000002   1.855295035085839;
   1.674244784831503  -0.000000000000007  -1.016264801768899   1.628534516152434  -0.000000000000006  -0.782794147314375  -0.000000000000013  -7.025177770998424   1.450963485097343  -0.000000000000001  -1.705111264474680   1.855295035085839;
  -0.000000000000005   1.674244784831506   1.016264801768897  -0.000000000000002   1.628534516152436   0.782794147314376   7.025177770998413   0.000000000000009   1.450963485097342   1.705111264474681   0.000000000000002   1.855295035085834
];

K2 = [
  -0.707106781186549   0.000000000000003  -0.500000000000001   0.500000000000000;
   0.000000000000004  -0.707106781186555   0.500000000000000   0.500000000000000;
   0.707106781186549  -0.000000000000005  -0.500000000000001   0.499999999999999;
  -0.000000000000002   0.707106781186556   0.500000000000001   0.499999999999998
];

u0 = sqrt(parameters.g * (parameters.M + 4 * parameters.m) / (4 * parameters.k1));
u_control = -(K1 * xhat + K2 * z) + [u0; -u0; u0; -u0];

end